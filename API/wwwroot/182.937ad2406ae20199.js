"use strict";(self.webpackChunkShoeStore_client=self.webpackChunkShoeStore_client||[]).push([[182],{2182:(S,l,r)=>{r.r(l),r.d(l,{CartModule:()=>v});var C=r(4466),i=r(6895),m=r(5698),t=r(4650),g=r(2175),p=r(3899),s=r(3060),u=r(4859),h=r(4004),d=r(262),_=r(9646);let f=(()=>{class e{constructor(n,a){this.cartService=n,this.authService=a,this.cartChange=new t.vpe}ngOnInit(){}removeCart(n){localStorage.getItem("token")?this.cartService.removeCart(n).subscribe(()=>this.pricesChange()):this.cartService.remCartAndUpdateCartSource(n),this.pricesChange(),this.authService.setCartItemsCount(this.cartService.getCartSourceFromObs().length),this.cartService.removeProductCartStorage(this.cartItem.productId)}changeQuantity(n){if(!localStorage.getItem("token"))return"inc"===n?(this.cartItem.subtotal=0,this.cartItem.subtotal+=++this.cartItem.quantity*this.cartItem.productPrice):(this.cartItem.subtotal=0,this.cartItem.subtotal+=--this.cartItem.quantity*this.cartItem.productPrice),this.cartService.AddProductCartItemsStorage({productId:this.cartItem.productId,quantity:this.cartItem.quantity}),void this.pricesChange();this.cartService.updateQuantity({productId:this.cartItem.productId,quantity:"inc"===n?++this.cartItem.quantity:--this.cartItem.quantity}).pipe((0,h.U)(c=>{this.cartItem.subtotal=0,this.cartItem.subtotal+=c.quantity*c.productPrice}),(0,d.K)(c=>("inc"===n?this.cartItem.quantity--:this.cartItem.quantity++,(0,_.of)(c)))).subscribe(()=>this.pricesChange())}pricesChange(){this.cartChange.emit()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g.N),t.Y36(p.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-cart-item"]],inputs:{cartItem:"cartItem"},outputs:{cartChange:"cartChange"},decls:23,vars:5,consts:[[1,"cart"],[1,"cart-image"],["alt","image",3,"src"],[1,"product-name"],[1,"quantity"],[1,"title"],[1,"quantity-details"],[1,"change-quantity",3,"disabled","click"],[1,"change-quantity",3,"click"],[1,"subtotal"],[1,"details"],[1,"remove-btn"],["mat-raised-button","","color","warn",3,"click"]],template:function(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"p",3),t._uU(4),t.qZA(),t.TgZ(5,"div",4)(6,"span",5),t._uU(7,"Quantity"),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t.NdJ("click",function(){return a.changeQuantity("dec")}),t._uU(10,"-"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.qZA(),t.TgZ(13,"button",8),t.NdJ("click",function(){return a.changeQuantity("inc")}),t._uU(14,"+"),t.qZA()()(),t.TgZ(15,"div",9)(16,"span",5),t._uU(17,"SubTotal"),t.qZA(),t.TgZ(18,"span",10),t._uU(19),t.qZA()(),t.TgZ(20,"div",11)(21,"button",12),t.NdJ("click",function(){return a.removeCart(a.cartItem.productId)}),t._uU(22,"Remove"),t.qZA()()()),2&n&&(t.xp6(2),t.Q6J("src",a.cartItem.productImage,t.LSH),t.xp6(2),t.Oqu(a.cartItem.productName),t.xp6(5),t.Q6J("disabled",1===a.cartItem.quantity),t.xp6(3),t.Oqu(a.cartItem.quantity),t.xp6(7),t.hij("$",a.cartItem.subtotal,""))},dependencies:[u.lW],styles:[".cart[_ngcontent-%COMP%]{position:relative;margin-top:20px;border:1px solid black;padding:10px;border-radius:10px;box-shadow:2px 2px 6px gray;display:flex;justify-content:space-between;flex-wrap:wrap;gap:5px}.cart-number[_ngcontent-%COMP%]{align-self:center;font-size:18px}.cart-image[_ngcontent-%COMP%]{flex:0 0 15%}.cart-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100px}.cart[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{flex:1;align-self:center}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%], .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]{flex:0 0 21%;display:flex;flex-direction:column;align-items:center;justify-content:center}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%], .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{font-size:18px;font-weight:700;margin-top:6px}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%], .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:10px;margin-top:10px}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px;font-weight:700;margin-top:6px}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid black;border-radius:50%;width:25px;height:25px;font-size:18px;font-weight:700;cursor:pointer}.cart[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled, .cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]   .quantity-details[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.6}.cart[_ngcontent-%COMP%]   .subtotal[_ngcontent-%COMP%]{flex:0 0 13%}.cart[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{flex:0 0 11%;align-self:center}"]}),e})();function P(e,o){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-cart-item",5),t.NdJ("cartChange",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.pricesChanged())}),t.qZA(),t.BQk()}if(2&e){const n=o.$implicit;t.xp6(1),t.Q6J("cartItem",n)}}function O(e,o){if(1&e&&(t.TgZ(0,"table",6)(1,"tr")(2,"th"),t._uU(3,"Total: "),t.TgZ(4,"span"),t._uU(5),t.qZA()()()()),2&e){const n=t.oxw();t.xp6(5),t.hij("$",n.totalPrice.toFixed(2),"")}}function M(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",7)(1,"a",8),t._uU(2,"Continue Shopping"),t.qZA(),t.TgZ(3,"button",9),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.checkout())}),t._uU(4,"Proceed To Checkout"),t.qZA()()}}function b(e,o){1&e&&(t.TgZ(0,"h3",10),t._uU(1,"No items in your cart yet"),t.qZA())}const x=[{path:"",component:(()=>{class e{constructor(n,a,c){this.cartService=n,this.authService=a,this.router=c,this.subTotal=0,this.totalPrice=0,this.tax=0}ngOnInit(){let n=localStorage.getItem("token");this.authService.currentUser$.pipe((0,m.q)(1)).subscribe(a=>this.user=a),n?this.cartService.getCart("fromDB").subscribe(a=>this.setPrices(a)):this.cartService.getCart("storage").subscribe(a=>{this.setPrices(a);const c=localStorage.getItem("cartProducts");if(c){const I=JSON.parse(c).length;this.authService.setCartItemsCount(I)}})}pricesChanged(){const n=this.cartService.getCartSourceFromObs();this.user&&(this.user.cartItemsCount=n.length,this.authService.setUser(this.user)),this.setPrices(n)}setPrices(n){this.subTotal=0,this.tax=0,this.totalPrice=0,n.forEach(a=>{this.subTotal+=a.quantity*a.productPrice}),this.totalPrice=this.subTotal}checkout(){this.user?this.cartService.createCheckoutSession().subscribe(n=>{this.user&&n?document.location.href=n:this.router.navigateByUrl("/auth/login?returnUrl=/cart")}):this.router.navigateByUrl("/auth/login?returnUrl=/cart")}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g.N),t.Y36(p.e),t.Y36(s.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-cart"]],decls:14,vars:13,consts:[[1,"cart-items"],[4,"ngFor","ngForOf"],["class","subtotal-tax",4,"ngIf","ngIfElse"],["class","action-btns",4,"ngIf"],["nocart",""],[3,"cartItem","cartChange"],[1,"subtotal-tax"],[1,"action-btns"],["mat-raised-button","","color","primary","routerLink","/products"],["mat-raised-button","","color","accent",3,"click"],[1,"nocart"]],template:function(n,a){if(1&n&&(t.TgZ(0,"h2"),t._uU(1,"Your cart"),t.qZA(),t.TgZ(2,"h3"),t._uU(3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"div",0),t.YNc(6,P,2,1,"ng-container",1),t.ALo(7,"async"),t.qZA(),t.YNc(8,O,6,1,"table",2),t.ALo(9,"async"),t.YNc(10,M,5,0,"div",3),t.ALo(11,"async"),t.YNc(12,b,2,0,"ng-template",null,4,t.W1O)),2&n){const c=t.MAs(13);t.xp6(3),t.hij("Total Items: ",t.lcZ(4,5,a.cartService.cart$).length,""),t.xp6(3),t.Q6J("ngForOf",t.lcZ(7,7,a.cartService.cart$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,9,a.cartService.cart$).length>0)("ngIfElse",c),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,11,a.cartService.cart$).length>0)}},dependencies:[i.sg,i.O5,s.yS,u.lW,u.zs,f,i.Ov],styles:["h2[_ngcontent-%COMP%]{padding-top:30px;text-decoration:underline;text-align:center}h3[_ngcontent-%COMP%]{margin-top:6px}.cart-items[_ngcontent-%COMP%]{margin-top:20px}.subtotal-tax[_ngcontent-%COMP%]{margin-left:auto}.subtotal-tax[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:flex;flex-direction:column;text-align:right}.subtotal-tax[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#8c8c8c;font-size:20px;text-transform:uppercase;margin-right:20px;border-bottom:1px solid grey;padding-bottom:6px;margin-top:14px}.subtotal-tax[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;color:#000;font-weight:700}.action-btns[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;margin-top:40px}.action-btns[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .action-btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:0 0 30%}.nocart[_ngcontent-%COMP%]{text-align:center;margin-top:20px}"]}),e})()}];let y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[s.Bz.forChild(x),s.Bz]}),e})(),v=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[i.ez,y,C.m]}),e})()}}]);